<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="teal.data">
<title>Join Keys • teal.data</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Join Keys">
<meta property="og:description" content="teal.data">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../consent.css">
<script src="../consent.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">teal.data</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/teal-data.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Get started</h6>
    <a class="dropdown-item" href="../articles/teal-data.html">Introduction to teal.data</a>
    <a class="dropdown-item" href="../articles/teal-data-reproducibility.html">teal_data reproducibility</a>
    <a class="dropdown-item" href="../articles/join-keys.html">Join Keys</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>

<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.8.0-rc1">v0.8.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.7.0">v0.7.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.7.0-rc1">v0.7.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.6.0">v0.6.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.6.0-rc1">v0.6.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.5.0">v0.5.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.5.0-rc1">v0.5.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.4.0">v0.4.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.4.0-rc1">v0.4.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.3.0">v0.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.2.0">v0.2.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal.data/v0.1.2">v0.1.2</a>
</div>
</li>
</ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/teal.data">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Join Keys</h1>
                        <h4 data-toc-skip class="author">NEST
CoreDev</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/teal.data/blob/HEAD/vignettes/join-keys.Rmd" class="external-link"><code>vignettes/join-keys.Rmd</code></a></small>
      <div class="d-none name"><code>join-keys.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>teal.data</code> package provides a way to define primary
keys for a dataset and establish relationships with other datasets.</p>
<p>Each dataset <em>joining keys</em> can be characterized by:</p>
<ul>
<li>Columns constituting the primary key;</li>
<li>Foreign/merge keys, analogous to <code>SQL</code> foreign keys.</li>
</ul>
<p>Typically, an application developer specifies these keys manually.
However, for datasets following the ADaM standard,
<code>teal.data</code> can automatically assign keys using the
<code>default_cdisc_join_keys</code> object. Refer to the section <a href="#join-keys-in-adam-datasets">“Joining Keys with ADaM Datasets”</a>
for details on using this object to select specific datasets.</p>
<div class="section level5">
<h5 id="uses-of-join_keys-class-in-teal-applications">Uses of <code>join_keys</code> class in <em>teal</em>
applications<a class="anchor" aria-label="anchor" href="#uses-of-join_keys-class-in-teal-applications"></a>
</h5>
<p>The primary function of the <code>join_keys</code> class in
<code>teal</code> applications is to facilitate the seamless <a href="https://insightsengineering.github.io/teal.transform/latest-tag/articles/data-merge.html" class="external-link">merging
of datasets</a> using <code>teal.transform</code>.</p>
<p>Additionally, it plays a role in the data filtering using the <em><a href="https://insightsengineering.github.io/teal/latest-tag/articles/filter-panel.html" class="external-link">Filter
Panel</a></em> in a <code>teal</code> application. The filters applied
to a (parent) dataset are also applied to their children.</p>
</div>
</div>
<div class="section level2">
<h2 id="anatomy-of-join_keys">Anatomy of <code>join_keys</code><a class="anchor" aria-label="anchor" href="#anatomy-of-join_keys"></a>
</h2>
<p>The <code>join_keys</code> object contains information about the
foreign/primary keys of multiple datasets. Each key is represented by a
pair of datasets (by name reference) and a named character vector that
encodes the column name mapping between the two datasets. In addition, a
foreign key may also contain a <em>parent-child</em> attribute that is
used in the “Filter Panel” as we mentioned above.</p>
<p>A new join keys can be created as an empty object, or by defining an
initial set of primary and foreign keys.</p>
<p>That initial object can be extended by adding/modifying/removing keys
and by establishing parent-child relationships between datasets.</p>
<div class="section level5">
<h5 id="join_keys----join-keys-constructor-getter-setter">
<code>join_keys(...)</code>: Join Keys Constructor / Getter /
Setter<a class="anchor" aria-label="anchor" href="#join_keys----join-keys-constructor-getter-setter"></a>
</h5>
<p>Convenient function that is used both as the constructor and as the
getter for <em>join_keys</em> objects.</p>
<p>As the <em>Getter</em> it is used to retrieve the <em>joining
keys</em> that are contained in other objects, such as a
<code>teal_data</code> object.</p>
<p>As the <em>Constructor</em> it is used to specify a collection of
multiple individual keys (via <code>join_key</code> function described
below).</p>
</div>
<div class="section level5">
<h5 id="join_keydataset_1-dataset_2-key-parent-single-join-key-constructor">
<code>join_key(dataset_1, dataset_2, key, parent)</code>: Single
Join Key Constructor<a class="anchor" aria-label="anchor" href="#join_keydataset_1-dataset_2-key-parent-single-join-key-constructor"></a>
</h5>
<p>Specifies a primary key or a relationship between two datasets.</p>
<ul>
<li>
<code>dataset_1</code>, <code>dataset_2</code>: names of the
datasets (if <code>dataset_2</code> is the same as
<code>dataset_1</code> or is omitted, it creates a primary key);</li>
<li>
<code>key</code>: named <code>character</code> vector of column name
mapping between datasets (unnamed vector assumes column names between
datasets are the same);</li>
<li>
<code>directed</code> (optional): flag that indicates whether there
is a <em>parent-child</em> directed relationship between
<code>dataset_2</code> to <code>dataset_1</code> (latter as a
parent).</li>
</ul>
<p>Note that join keys are assumed to be symmetric, i.e.,
<code>join_key("ds1", "ds2", c("ds1_col" = "ds2_col"))</code>
establishes a relationship from “x” to “y” and vice versa.</p>
<p>By default, the new joining key will set the <code>dataset_1</code>
as the parent.</p>
</div>
<div class="section level5">
<h5 id="example-output">Example &amp; Output<a class="anchor" aria-label="anchor" href="#example-output"></a>
</h5>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/teal.data/">teal.data</a></span><span class="op">)</span></span>
<span><span class="va">jk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, keys <span class="op">=</span> <span class="st">"col_1"</span><span class="op">)</span>, <span class="co"># ds1: [col_1]</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col_1"</span>, <span class="st">"col_2"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># ds2: [col_1, col_2]</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds3"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col_1"</span>, <span class="st">"col_3"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># ds3: [col_1, col_3]</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, keys <span class="op">=</span> <span class="st">"col_1"</span><span class="op">)</span>, <span class="co"># ds1 &lt;-- ds2</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds3"</span>, keys <span class="op">=</span> <span class="st">"col_1"</span><span class="op">)</span>, <span class="co"># ds1 &lt;-- ds3</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds4"</span>, <span class="st">"ds5"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col_4"</span> <span class="op">=</span> <span class="st">"col_5"</span><span class="op">)</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># ds4 &lt;--&gt; ds5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The parent-child relationships are created automatically (unless 'parent' parameter is "none")</span></span>
<span><span class="va">jk</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="44%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th>Output of <code>print(jk)</code>
</th>
<th align="center">Output annotation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>## A join_keys object containing foreign keys between 3 datasets:</code></td>
<td align="center"><strong>Title</strong></td>
</tr>
<tr class="even">
<td><code>## ds1: [col_1]</code></td>
<td align="center">
<strong>Primary keys</strong><br><em>&lt;dataset
name&gt;</em>: [<em>&lt;primary_keys&gt;</em>]</td>
</tr>
<tr class="odd">
<td><code>##   &lt;-- ds2: [col_1]</code></td>
<td align="center">
<strong>Foreign keys</strong><br><em>(arrow
<code>&lt;--</code> denotes <code>ds1</code> is the parent of
<code>ds2</code>)</em>
</td>
</tr>
<tr class="even">
<td><code>##   &lt;-- ds3: [col_1]</code></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td><code>## ds2: [col_1, col_2]</code></td>
<td align="center"></td>
</tr>
<tr class="even">
<td><code>##   --&gt; ds1: [col_1]</code></td>
<td align="center">arrow <code>--&gt;</code> denotes <code>ds2</code> is
a child of <code>ds1</code>
</td>
</tr>
<tr class="odd">
<td><code>##   --* (implicit via parent with): ds3</code></td>
<td align="center">
<strong>Implicit relationship between
<code>ds2</code> &amp; <code>ds3</code></strong><br><em>(given that
they share common keys with same parent)</em>
</td>
</tr>
<tr class="even">
<td><code>## ds3: [col_1, col_3]</code></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td><code>##   --&gt; ds1: [col_1]</code></td>
<td align="center"></td>
</tr>
<tr class="even">
<td><code>##   --* (implicit via parent with): ds2</code></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td><code>## ds4: [no primary keys]</code></td>
<td align="center"></td>
</tr>
<tr class="even">
<td><code>##   &lt;-&gt; ds5: [col_5]</code></td>
<td align="center">
<strong>Foreign keys</strong> <br><em>(arrow
<code>&lt;-&gt;</code> denotes no parent definition between
datasets)</em>
</td>
</tr>
<tr class="odd">
<td><code>## ds5: [no primary keys]</code></td>
<td align="center"></td>
</tr>
<tr class="even">
<td><code>##   &lt;-&gt; ds4: [col_4]</code></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="accessing-and-modifying-keys">Accessing and Modifying keys<a class="anchor" aria-label="anchor" href="#accessing-and-modifying-keys"></a>
</h2>
<p>The <em>subset</em> operator with 2 indices (<code>x[i, j]</code>) is
used to retrieve the primary/foreign keys. Both indices must be a string
denoting the dataset name.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the jk object defined in "Anatomy of Join Keys"</span></span>
<span><span class="va">jk</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 5 datasets:</span></span>
<span><span class="co">## ds1: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds2: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds3: [col_1]</span></span>
<span><span class="co">## ds2: [col_1, col_2]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span>
<span><span class="co">##   --* (implicit via parent with): ds3</span></span>
<span><span class="co">## ds3: [col_1, col_3]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span>
<span><span class="co">##   --* (implicit via parent with): ds2</span></span>
<span><span class="co">## ds4: [no primary keys]</span></span>
<span><span class="co">##   &lt;-&gt; ds5: [col_5]</span></span>
<span><span class="co">## ds5: [no primary keys]</span></span>
<span><span class="co">##   &lt;-&gt; ds4: [col_4]</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Getting primary key of "ds1"</span></span>
<span><span class="va">jk</span><span class="op">[</span><span class="st">"ds1"</span>, <span class="st">"ds1"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   col_1 </span></span>
<span><span class="co">## "col_1"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Getting foreign keys between "ds4" and "ds5"</span></span>
<span><span class="va">jk</span><span class="op">[</span><span class="st">"ds4"</span>, <span class="st">"ds5"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   col_4 </span></span>
<span><span class="co">## "col_5"</span></span></code></pre>
<p>Note that there is a symmetry in the keys between <code>ds4</code>
and <code>ds5</code> relationship:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jk</span><span class="op">[</span><span class="st">"ds5"</span>, <span class="st">"ds4"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   col_5 </span></span>
<span><span class="co">## "col_4"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jk</span><span class="op">[</span><span class="st">"ds5"</span>, <span class="st">"ds4"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   col_5 </span></span>
<span><span class="co">## "col_4"</span></span></code></pre>
<p>When only 1 argument is used this operator will return a
<code>join_keys</code> object that is filtered accordingly.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the jk object defined in "Anatomy of Join Keys"</span></span>
<span><span class="va">jk</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 5 datasets:</span></span>
<span><span class="co">## ds1: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds2: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds3: [col_1]</span></span>
<span><span class="co">## ds2: [col_1, col_2]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span>
<span><span class="co">##   --* (implicit via parent with): ds3</span></span>
<span><span class="co">## ds3: [col_1, col_3]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span>
<span><span class="co">##   --* (implicit via parent with): ds2</span></span>
<span><span class="co">## ds4: [no primary keys]</span></span>
<span><span class="co">##   &lt;-&gt; ds5: [col_5]</span></span>
<span><span class="co">## ds5: [no primary keys]</span></span>
<span><span class="co">##   &lt;-&gt; ds4: [col_4]</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Getting primary key of "ds1"</span></span>
<span><span class="va">jk</span><span class="op">[</span><span class="st">"ds1"</span>, <span class="st">"ds1"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   col_1 </span></span>
<span><span class="co">## "col_1"</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Getting keys of "ds1" and "ds2"</span></span>
<span><span class="va">jk</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 2 datasets:</span></span>
<span><span class="co">## ds1: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds2: [col_1]</span></span>
<span><span class="co">## ds2: [col_1, col_2]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span></code></pre>
<p>Modifying or adding a key uses the same notation with the assignment
operator <code>&lt;-</code>. A symmetric relationship will be created
automatically, where the parent (by default) will be the dataset defined
in the first index. Assigning <code>NULL</code> value will delete the
relationship.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding a new ds5 &lt;-- ds1 key</span></span>
<span><span class="va">jk</span><span class="op">[</span><span class="st">"ds1"</span>, <span class="st">"ds5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"a_column"</span></span>
<span></span>
<span><span class="co"># Removing an existing key</span></span>
<span><span class="va">jk</span><span class="op">[</span><span class="st">"ds4"</span>, <span class="st">"ds5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merging-join-keys">Merging Join Keys<a class="anchor" aria-label="anchor" href="#merging-join-keys"></a>
</h2>
<p>The combining of multiple <em>joining keys</em> is achieved using the
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> generic function, which generates a symmetric and valid
<code>join_keys</code> object. When encountering identical relationship
pairs, this operation retains the last occurrence of the pair within the
specified argument order.</p>
<p>For added convenience, the function also accommodates
<code>join_key_set</code> objects created through the
<code>join_key</code> function. These objects can be provided as the
initial argument or in any other position as needed.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jk1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds1"</span>, <span class="st">"col_1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">jk2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, <span class="st">"ds2"</span>, <span class="st">"col_1"</span><span class="op">)</span>, <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, <span class="st">"col_1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merging</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jk1</span>, <span class="va">jk2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 2 datasets:</span></span>
<span><span class="co">## ds1: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds2: [col_1]</span></span>
<span><span class="co">## ds2: [col_1]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keeping last occurence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jk1</span>, <span class="va">jk2</span>, <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, <span class="st">"ds2"</span>, <span class="st">"col_2"</span><span class="op">)</span>, <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col_1"</span> <span class="op">=</span> <span class="st">"col_2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 2 datasets:</span></span>
<span><span class="co">## ds1: [col_1]</span></span>
<span><span class="co">##   &lt;-- ds2: [col_2]</span></span>
<span><span class="co">## ds2: [col_2]</span></span>
<span><span class="co">##   --&gt; ds1: [col_1]</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merges join_key and join_key_set objects (from join_key function)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jk1</span>, <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds3"</span>, <span class="st">"ds3"</span>, <span class="st">"col_3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 2 datasets:</span></span>
<span><span class="co">## ds1: [col_1]</span></span>
<span><span class="co">## ds3: [col_3]</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="join-keys-relationships">Join Keys Relationships<a class="anchor" aria-label="anchor" href="#join-keys-relationships"></a>
</h2>
<p>There are 2 types of relationships encoded with <em>joining keys</em>
that are described in the following sections. The <em>primary</em> and
<em>foreign</em> keys are created explicitly using the constructor for
individual keys (<code>join_key</code>).</p>
<p>Additionally, the <code>join_keys</code> object infers implicit
relationships when two datasets share foreign keys to a parent dataset,
but not between themselves. These implicit relationships are available
just like another foreign key and can be used to merge datasets, despite
not being defined by the user.</p>
<div class="section level3">
<h3 id="primary-key-with-teal_data">Primary Key with <code>teal_data</code><a class="anchor" aria-label="anchor" href="#primary-key-with-teal_data"></a>
</h3>
<p>When using the <code>teal_data</code> function, the simplest method
to define the join keys is to use the <code>join_keys</code> argument.
We can specify the column(s) of the dataset that (together) uniquely
identify rows in the dataset.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/teal.data/">teal.data</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">td_pk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">ds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">iris</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/datanames.html">datanames</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ds1"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, keys <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 1 datasets:</span></span>
<span><span class="co">## ds1: [id]</span></span></code></pre>
<p>We can extend the previous example and define primary keys for
multiple datasets:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td_pk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span></span>
<span>  <span class="va">td_pk</span>,</span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">ds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>W <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">1</span>, V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ds3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, N <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/datanames.html">datanames</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/datanames.html">datanames</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span>, <span class="st">"ds2"</span>, <span class="st">"ds3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span><span class="op">[</span><span class="st">"ds2"</span>, <span class="st">"ds2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span><span class="op">[</span><span class="st">"ds3"</span>, <span class="st">"ds3"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"W"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_pk</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 3 datasets:</span></span>
<span><span class="co">## ds1: [id]</span></span>
<span><span class="co">## ds2: [V, W]</span></span>
<span><span class="co">## ds3: [V, W]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="foreign-keys-with-teal_data">Foreign Keys with <code>teal_data</code><a class="anchor" aria-label="anchor" href="#foreign-keys-with-teal_data"></a>
</h3>
<p>When passing multiple datasets to the <code>teal_data</code>
function, dataset relationships are set using <code>join_keys</code> and
<code>join_key</code> functions, which then can be used to merge
datasets together within <code>teal</code> apps. For users familiar with
<code>SQL</code> database schema, these relationships are symmetric and
not as strict as <code>SQL</code> foreign key relationships as
<code>teal</code> does not validate whether the values defined as
foreign key columns are present in the table.</p>
<p>For example:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/teal.data/">teal.data</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">td_fk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">ds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, Y <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span>, Z <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="va">ds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>W <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">1</span>, V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ds3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, N <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/datanames.html">datanames</a></span><span class="op">(</span><span class="va">td_fk</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, <span class="st">"ds3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_fk</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span></span>
<span>  <span class="co"># Primary keys</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"W"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds3"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># Foreign keys</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span> <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, <span class="st">"ds3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span> <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td_fk</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 3 datasets:</span></span>
<span><span class="co">## ds1: [X]</span></span>
<span><span class="co">##   &lt;-- ds2: [W]</span></span>
<span><span class="co">## ds2: [V, W]</span></span>
<span><span class="co">##   --&gt; ds1: [X]</span></span>
<span><span class="co">##   &lt;-- ds3: [V]</span></span>
<span><span class="co">## ds3: [V]</span></span>
<span><span class="co">##   --&gt; ds2: [V]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="implicit-relationships">Implicit Relationships<a class="anchor" aria-label="anchor" href="#implicit-relationships"></a>
</h3>
<p>Two datasets that share common <em>foreign</em> keys to the same
<em>parent</em> dataset have an implicit relationship between them that
is modeled and accessible in <em>joining keys</em>.</p>
<p>This is a special relationship that is inferred from existing foreign
keys. It does not need to be explicitly defined but it can be accessed
and overwritten just as any other foreign key.</p>
<p>These implicit relationships can be used to merge 2 datasets
together, just as if they were defined manually.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/teal.data/">teal.data</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">ds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, Y <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span>, Z <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="va">ds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>W <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">1</span>, V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ds3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, N <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">ds4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>V <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">14</span>, R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/datanames.html">datanames</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, <span class="st">"ds3"</span>, <span class="st">"ds4"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span></span>
<span>  <span class="co"># Primary keys</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"W"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds3"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds4"</span>, keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># Foreign keys</span></span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span> <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds2"</span>, <span class="st">"ds3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span> <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/join_key.html">join_key</a></span><span class="op">(</span><span class="st">"ds1"</span>, <span class="st">"ds4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span> <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 4 datasets:</span></span>
<span><span class="co">## ds1: [X]</span></span>
<span><span class="co">##   &lt;-- ds2: [W]</span></span>
<span><span class="co">##   &lt;-- ds4: [B]</span></span>
<span><span class="co">## ds2: [V, W]</span></span>
<span><span class="co">##   --&gt; ds1: [X]</span></span>
<span><span class="co">##   &lt;-- ds3: [V]</span></span>
<span><span class="co">##   --* (implicit via parent with): ds4</span></span>
<span><span class="co">## ds3: [V]</span></span>
<span><span class="co">##   --&gt; ds2: [V]</span></span>
<span><span class="co">## ds4: [V]</span></span>
<span><span class="co">##   --&gt; ds1: [X]</span></span>
<span><span class="co">##   --* (implicit via parent with): ds2</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/join_keys.html">join_keys</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span><span class="op">[</span><span class="st">"ds2"</span>, <span class="st">"ds4"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   W </span></span>
<span><span class="co">## "B"</span></span></code></pre>
<p>Note that the definition above contains no <code>join_key</code> for
<code>"ds2" &lt;-&gt; "ds4"</code></p>
</div>
</div>
<div class="section level2">
<h2 id="join-keys-in-adam-datasets">
<em>Join Keys</em> in ADaM Datasets<a class="anchor" aria-label="anchor" href="#join-keys-in-adam-datasets"></a>
</h2>
<p><code>teal.data</code> provides a set of default join keys (primary
and foreign) for datasets named according to the ADaM standard. They are
stored in <code>default_cdisc_join_keys</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">default_cdisc_join_keys</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "ADAE"     "ADAETTE"  "ADCM"     "ADCSSRS"  "ADDV"     "ADEG"    </span></span>
<span><span class="co">##  [7] "ADEQ5D5L" "ADEX"     "ADHY"     "ADLB"     "ADMH"     "ADQLQC"  </span></span>
<span><span class="co">## [13] "ADQS"     "ADRS"     "ADSAFTTE" "ADSL"     "ADSUB"    "ADTTE"   </span></span>
<span><span class="co">## [19] "ADVS"</span></span></code></pre>
<p>When not all default keys are required users can select a smaller set
of datasets by subsetting (for example:
<code>default_cdisc_join_keys[c("ADSL", "ADTTE")]</code>). Please note,
that for every element that is selected, its parent will also be
returned (if it has one) as well as any pair-wise relationships in the
resulting selection.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_cdisc_join_keys</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 19 datasets:</span></span>
<span><span class="co">## ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADAE: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADEG: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADTTE: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADAETTE: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADCM: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADEX: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADLB: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADMH: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADQS: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADRS: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADSAFTTE: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADVS: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADDV: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADSUB: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADHY: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADQLQC: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADCSSRS: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADEQ5D5L: [STUDYID, USUBJID]</span></span>
<span><span class="co">## ADAE: [STUDYID, USUBJID, ASTDTM, AETERM, AESEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADEG: [STUDYID, USUBJID, PARAMCD, AVISIT]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADTTE: [STUDYID, USUBJID, PARAMCD]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADAETTE: [STUDYID, USUBJID, PARAMCD]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADCM: [STUDYID, USUBJID, ASTDTM, CMSEQ, ATC1CD, ATC2CD, ATC3CD, ATC4CD]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADEX: [STUDYID, USUBJID, PARCAT1, PARAMCD, AVISITN, ASTDTM, EXSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADLB: [STUDYID, USUBJID, PARAMCD, AVISIT]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADMH: [STUDYID, USUBJID, ASTDTM, MHSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADQS: [STUDYID, USUBJID, PARAMCD, AVISIT]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADRS: [STUDYID, USUBJID, PARAMCD, AVISIT]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADSAFTTE: [STUDYID, USUBJID, PARAMCD]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADVS: [STUDYID, USUBJID, PARAMCD, AVISIT]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADDV: [STUDYID, USUBJID, ASTDT, DVTERM, DVSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADSUB, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADSUB: [STUDYID, USUBJID, PARAMCD, AVISITN, ADTM, SRCSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADHY, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADHY: [STUDYID, USUBJID, PARAMCD, AVISITN, ADTM, SRCSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADQLQC, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADQLQC: [STUDYID, USUBJID, PARCAT1N, PARAMCD, BASETYPE, AVISITN, ATPTN, ADTM, QSSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADCSSRS, ADEQ5D5L</span></span>
<span><span class="co">## ADCSSRS: [STUDYID, USUBJID, PARAMCD, BASETYPE, AVISITN, DTYPE, ADTM]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADEQ5D5L</span></span>
<span><span class="co">## ADEQ5D5L: [STUDYID, USUBJID, PARCAT1N, PARAMCD, BASETYPE, AVISITN, ATPTN, ADTM, QSSEQ]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADAE, ADEG, ADTTE, ADAETTE, ADCM, ADEX, ADLB, ADMH, ADQS, ADRS, ADSAFTTE, ADVS, ADDV, ADSUB, ADHY, ADQLQC, ADCSSRS</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_cdisc_join_keys</span><span class="op">[</span><span class="st">"ADSL"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 1 datasets:</span></span>
<span><span class="co">## ADSL: [STUDYID, USUBJID]</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_cdisc_join_keys</span><span class="op">[</span><span class="st">"ADTTE"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 2 datasets:</span></span>
<span><span class="co">## ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADTTE: [STUDYID, USUBJID]</span></span>
<span><span class="co">## ADTTE: [STUDYID, USUBJID, PARAMCD]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_cdisc_join_keys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="st">"ADTTE"</span>, <span class="st">"ADRS"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## A join_keys object containing foreign keys between 3 datasets:</span></span>
<span><span class="co">## ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADTTE: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   &lt;-- ADRS: [STUDYID, USUBJID]</span></span>
<span><span class="co">## ADTTE: [STUDYID, USUBJID, PARAMCD]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADRS</span></span>
<span><span class="co">## ADRS: [STUDYID, USUBJID, PARAMCD, AVISIT]</span></span>
<span><span class="co">##   --&gt; ADSL: [STUDYID, USUBJID]</span></span>
<span><span class="co">##   --* (implicit via parent with): ADTTE</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="nest">
  <p>teal.data is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer>
</div>

  

  

  </body>
</html>
